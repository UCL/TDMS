<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TDMS: tdms/tests/unit/test_interpolation_functions.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">TDMS
   </div>
   <div id="projectbrief">Time Domain Maxwell Solver</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('test__interpolation__functions_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">test_interpolation_functions.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Tests the performance of the interpolation functions, using 1D data mimicing a coordinate axes.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;catch2/catch_approx.hpp&gt;</code><br />
<code>#include &lt;catch2/catch_test_macros.hpp&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;complex&gt;</code><br />
<code>#include &lt;spdlog/spdlog.h&gt;</code><br />
<code>#include &quot;<a class="el" href="globals_8h_source.html">globals.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="interpolation__methods_8h_source.html">interpolation_methods.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for test_interpolation_functions.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="test__interpolation__functions_8cpp__incl.png" border="0" usemap="#tdms_2tests_2unit_2test__interpolation__functions_8cpp" alt=""/></div>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8cd1d078e64e910e73b215be6901d3a2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__interpolation__functions_8cpp.html#a8cd1d078e64e910e73b215be6901d3a2">TEST_CASE</a> (&quot;test_interpolation_functions: testing that cubic interpolation is exact&quot;)</td></tr>
<tr class="memdesc:a8cd1d078e64e910e73b215be6901d3a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">In the case when cubic interpolation is to be used, check that all polynomial fields up to cubic order are interpolated exactly (to within machine error)  <a href="test__interpolation__functions_8cpp.html#a8cd1d078e64e910e73b215be6901d3a2">More...</a><br /></td></tr>
<tr class="separator:a8cd1d078e64e910e73b215be6901d3a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0280f29451a037b48a01c2990dae70cf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__interpolation__functions_8cpp.html#a0280f29451a037b48a01c2990dae70cf">TEST_CASE</a> (&quot;bandlimited_interpolation: check that the interpolation constant values all sum to the same value&quot;)</td></tr>
<tr class="memdesc:a0280f29451a037b48a01c2990dae70cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">The hard-coded numerical values for the interpolation constant should all sum to the same value.  <a href="test__interpolation__functions_8cpp.html#a0280f29451a037b48a01c2990dae70cf">More...</a><br /></td></tr>
<tr class="separator:a0280f29451a037b48a01c2990dae70cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a715ec5ce34344c0744a14d2c83e31f04"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__interpolation__functions_8cpp.html#a715ec5ce34344c0744a14d2c83e31f04">TEST_CASE</a> (&quot;(real-valued) Band limited interpolation: constant function&quot;)</td></tr>
<tr class="memdesc:a715ec5ce34344c0744a14d2c83e31f04"><td class="mdescLeft">&#160;</td><td class="mdescRight">We will check that BLi interpolation over real-valued data gives comparible error to the equivalent functions in MATLAB.  <a href="test__interpolation__functions_8cpp.html#a715ec5ce34344c0744a14d2c83e31f04">More...</a><br /></td></tr>
<tr class="separator:a715ec5ce34344c0744a14d2c83e31f04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d108766f0dfdad187386ace5c41c2f1"><td class="memItemLeft" align="right" valign="top"><a id="a5d108766f0dfdad187386ace5c41c2f1"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>s2pi</b> (double x)</td></tr>
<tr class="separator:a5d108766f0dfdad187386ace5c41c2f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bc0db44637deb2cd9767d4b91c41276"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__interpolation__functions_8cpp.html#a5bc0db44637deb2cd9767d4b91c41276">TEST_CASE</a> (&quot;(real-valued) Band limited interpolation: sin(2 pi x)&quot;)</td></tr>
<tr class="memdesc:a5bc0db44637deb2cd9767d4b91c41276"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test BLi performance on the sine function.  <a href="test__interpolation__functions_8cpp.html#a5bc0db44637deb2cd9767d4b91c41276">More...</a><br /></td></tr>
<tr class="separator:a5bc0db44637deb2cd9767d4b91c41276"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad17a21176892d180e5596b1e3b117b49"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__interpolation__functions_8cpp.html#ad17a21176892d180e5596b1e3b117b49">pulse</a> (double x)</td></tr>
<tr class="memdesc:ad17a21176892d180e5596b1e3b117b49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluates the smooth pulse/ mollifier Kernel function, supported between 0 and 1.  <a href="test__interpolation__functions_8cpp.html#ad17a21176892d180e5596b1e3b117b49">More...</a><br /></td></tr>
<tr class="separator:ad17a21176892d180e5596b1e3b117b49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae55266e0873a11a37e901e870fa7ea65"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__interpolation__functions_8cpp.html#ae55266e0873a11a37e901e870fa7ea65">TEST_CASE</a> (&quot;(real-valued) Band limited interpolation: compact <a class="el" href="test__interpolation__functions_8cpp.html#ad17a21176892d180e5596b1e3b117b49">pulse</a>&quot;)</td></tr>
<tr class="memdesc:ae55266e0873a11a37e901e870fa7ea65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test BLi performance on the compact pulse.  <a href="test__interpolation__functions_8cpp.html#ae55266e0873a11a37e901e870fa7ea65">More...</a><br /></td></tr>
<tr class="separator:ae55266e0873a11a37e901e870fa7ea65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8da3d3c727c8210af079fea9905be9e9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__interpolation__functions_8cpp.html#a8da3d3c727c8210af079fea9905be9e9">TEST_CASE</a> (&quot;(complex-valued) Band limited interpolation&quot;)</td></tr>
<tr class="memdesc:a8da3d3c727c8210af079fea9905be9e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">We will check that BLi interpolation over complex-valued data gives comparible error to the equivalent functions in MATLAB.  <a href="test__interpolation__functions_8cpp.html#a8da3d3c727c8210af079fea9905be9e9">More...</a><br /></td></tr>
<tr class="separator:a8da3d3c727c8210af079fea9905be9e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Tests the performance of the interpolation functions, using 1D data mimicing a coordinate axes. </p>
<dl class="section author"><dt>Author</dt><dd>William Graham (<a href="#" onclick="location.href='mai'+'lto:'+'cca'+'eg'+'ra@'+'uc'+'l.a'+'c.'+'uk'; return false;">ccaeg<span style="display: none;">.nosp@m.</span>ra@u<span style="display: none;">.nosp@m.</span>cl.ac<span style="display: none;">.nosp@m.</span>.uk</a>) </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ad17a21176892d180e5596b1e3b117b49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad17a21176892d180e5596b1e3b117b49">&#9670;&nbsp;</a></span>pulse()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double pulse </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluates the smooth pulse/ mollifier Kernel function, supported between 0 and 1. </p>
<p>The smooth mollifier \phi(x) is the function \phi(x) = \begin{cases} 0 &amp; when |x| &gt;= 1, e^{-1/(1-|x|^2)} &amp; when |x| &lt; 1 \end{cases} This function is compactly supported over the interval [-1,1]. By evaluating pulse(x) = \phi(3[2x-1]), we obtain a smooth function with support in [1/3,2/3] \subset [0,1]</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>Point of evaluation </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double Evaluted value </dd></dl>

</div>
</div>
<a id="a8da3d3c727c8210af079fea9905be9e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8da3d3c727c8210af079fea9905be9e9">&#9670;&nbsp;</a></span>TEST_CASE() <span class="overload">[1/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;(complex-valued) Band limited interpolation&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>We will check that BLi interpolation over complex-valued data gives comparible error to the equivalent functions in MATLAB. </p>
<p>For 100 sample points, we will use BLi to interpolate the following complex-valued function with 100 sample points: real part of sin(2\pi x) imag part of pulse function.</p>
<p>Interoplation will then be tested against over the range [0,1], the max element-wise error (by absolute value) will be determined. We will then check that this is of the same order of magnitude as the error produced by MATLAB, 5.35317432e-04. </p>

</div>
</div>
<a id="ae55266e0873a11a37e901e870fa7ea65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae55266e0873a11a37e901e870fa7ea65">&#9670;&nbsp;</a></span>TEST_CASE() <span class="overload">[2/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;(real-valued) Band limited interpolation: compact <a class="el" href="test__interpolation__functions_8cpp.html#ad17a21176892d180e5596b1e3b117b49">pulse</a>&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test BLi performance on the compact pulse. </p>
<ul>
<li>pulse function : range 0,1 : max. element-wise error (MATLAB) 4.87599933e-04 </li>
</ul>

</div>
</div>
<a id="a715ec5ce34344c0744a14d2c83e31f04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a715ec5ce34344c0744a14d2c83e31f04">&#9670;&nbsp;</a></span>TEST_CASE() <span class="overload">[3/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;(real-valued) Band limited interpolation: constant function&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>We will check that BLi interpolation over real-valued data gives comparible error to the equivalent functions in MATLAB. </p>
<p>For 100 sample points, we will use BLi to interpolate the following functions with 100 sample points:</p><ul>
<li>The constant function 1 : range 0,1 : max. element-wise error (MATLAB) 2.82944733e-04</li>
<li>sin(2\pi x) : range 0,1 : max. element-wise error (MATLAB) 2.63468327e-04</li>
<li>pulse function : range 0,1 : max. element-wise error (MATLAB) 4.87599933e-04 Error values produced from benchmark_test_interpolation_functions.m</li>
</ul>
<p>We will then compare the maximum of the pointwise error between the interpolated values and exact values to the same quantity computed via MATLAB's interp function, and determine whether the order of magnitude of the errors is the same.</p>
<p>For readability, we break this out into separate test cases for each function.</p>
<p>Test BLi performance on the constant function.</p><ul>
<li>The constant function 1 : range 0,1 : max. element-wise error (MATLAB) 2.82944733e-04 </li>
</ul>

</div>
</div>
<a id="a5bc0db44637deb2cd9767d4b91c41276"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bc0db44637deb2cd9767d4b91c41276">&#9670;&nbsp;</a></span>TEST_CASE() <span class="overload">[4/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;(real-valued) Band limited interpolation: sin(2 pi x)&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test BLi performance on the sine function. </p>
<ul>
<li>sin(2\pi x) : range 0,1 : max. element-wise error (MATLAB) 2.63468327e-04 </li>
</ul>

</div>
</div>
<a id="a0280f29451a037b48a01c2990dae70cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0280f29451a037b48a01c2990dae70cf">&#9670;&nbsp;</a></span>TEST_CASE() <span class="overload">[5/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;bandlimited_interpolation: check that the interpolation constant values all sum to the same value&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The hard-coded numerical values for the interpolation constant should all sum to the same value. </p>
<p>Note - the coefficients are not required to sum to unity! </p>

</div>
</div>
<a id="a8cd1d078e64e910e73b215be6901d3a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cd1d078e64e910e73b215be6901d3a2">&#9670;&nbsp;</a></span>TEST_CASE() <span class="overload">[6/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;test_interpolation_functions: testing that cubic interpolation is exact&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>In the case when cubic interpolation is to be used, check that all polynomial fields up to cubic order are interpolated exactly (to within machine error) </p>
<p>Checks are run on both the old interp{1,2,3} functions and newer const Interp_scheme instances. Old cubic methods will be redundant upon integration of BLi into the codebase. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_dfaedd75726dc0f14b5d7f96fe9da9ad.html">tdms</a></li><li class="navelem"><a class="el" href="dir_99e68cfdfe0514ef618d04f980ae72d7.html">tests</a></li><li class="navelem"><a class="el" href="dir_35da79734557ee91ec31d6196f63b455.html">unit</a></li><li class="navelem"><a class="el" href="test__interpolation__functions_8cpp.html">test_interpolation_functions.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
